fn @range(body: fn (i32) -> ()) {
    fn loop(a: i32, b: i32) -> () {
        if a < b {
            body(a);
            loop(a + 1, b)
        }
    }
    loop
}

#[export]
fn foo(count: i32, buf: &mut[i32]) -> i32 {
    let mut acc = 0;
    let r = return;
    let skip: fn() -> () = || { r(69) };
    for i in range(0, count) {
        let r = buf(i);
        acc += r;
        if r == 0 {
            skip()
        }
    }
    acc
}
